import{e as I}from"./chunk-TJS7GMF3.js";import{$a as c,H as n,K as p,L as g,Q as _,Qa as C,Ua as S,W as v,cb as w,db as y,eb as j,gb as f,lb as b,q as h,r as u,sb as M,t as s,ub as k}from"./chunk-76546ULM.js";var A={formId:"manaforgeartifact",title:"Manaforgeartifact",components:[{name:"Text",key:"name",focused:!0,fields:[{name:"Placeholder",value:"fill manaforgeartifact title"},{name:"Label",value:"Title"}]},{name:"Text",key:"description",fields:[{name:"Placeholder",value:"fill manaforgeartifact description"},{name:"Label",value:"Description"}]}]};var F=(()=>{class i extends w{constructor(r,e,t,a){super({name:"manaforgeartifact"},r,e,t,a),this.manaforgeartifacts=this.getDocs(),this.manaforgeartifactsByAuthor={},this.get(),this.filteredDocuments(this.manaforgeartifactsByAuthor)}static{this.\u0275fac=function(e){return new(e||i)(s(j),s(y),s(f),s(c))}}static{this.\u0275prov=h({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var d=(()=>{class i{get rows(){return this._manaforgeartifactService.manaforgeartifacts}constructor(r,e,t,a,m,D){this._translate=r,this._manaforgeartifactService=e,this._alert=t,this._form=a,this._core=m,this._router=D,this.world=this._router.url.includes("/artifacts/")?this._router.url.split("/")[2]:"",this.dungeon=this._router.url.includes("/artifacts/")?this._router.url.split("/")[3]:"",this.columns=["name","description"],this.form=this._form.getForm("manaforgeartifact",A),this.config={create:()=>{this._form.modal(this.form,{label:"Create",click:(o,l)=>{this._preCreate(o),this._manaforgeartifactService.create(o),l()}})},update:o=>{this._form.modal(this.form,[],o).then(l=>{this._core.copy(l,o),this._manaforgeartifactService.update(o)})},delete:o=>{this._alert.question({text:this._translate.translate("Common.Are you sure you want to delete this manaforgeartifact?"),buttons:[{text:this._translate.translate("Common.No")},{text:this._translate.translate("Common.Yes"),callback:()=>{this._manaforgeartifactService.delete(o)}}]})},buttons:[{icon:"cloud_download",click:o=>{this._form.modalUnique("manaforgeartifact","url",o)}}],headerButtons:[{icon:"playlist_add",click:this._bulkManagement(),class:"playlist"},{icon:"edit_note",click:this._bulkManagement(!1),class:"edit"}]}}_bulkManagement(r=!0){return()=>{this._form.modalDocs(r?[]:this.rows).then(e=>{if(r)for(let t of e)this._preCreate(t),this._manaforgeartifactService.create(t);else{for(let t of this.rows)e.find(a=>a._id===t._id)||this._manaforgeartifactService.delete(t);for(let t of e){let a=this.rows.find(m=>m._id===t._id);a?(this._core.copy(t,a),this._manaforgeartifactService.update(a)):(this._preCreate(t),this._manaforgeartifactService.create(t))}}})}}_preCreate(r){r.__created,this.world&&(r.world=this.world),this.dungeon&&(r.dungeon=this.dungeon)}static{this.\u0275fac=function(e){return new(e||i)(n(b),n(F),n(f),n(k),n(c),n(C))}}static{this.\u0275cmp=p({type:i,selectors:[["ng-component"]],standalone:!1,decls:1,vars:3,consts:[["title","Artifacts",3,"columns","config","rows"]],template:function(e,t){e&1&&v(0,"wtable",0),e&2&&_("columns",t.columns)("config",t.config)("rows",t.rows)},dependencies:[M],encapsulation:2})}}return i})();var N=[{path:"",component:d},{path:":world/:dungeon",component:d}],K=(()=>{class i{static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275mod=g({type:i})}static{this.\u0275inj=u({imports:[S.forChild(N),I]})}}return i})();export{K as ArtifactsModule};
